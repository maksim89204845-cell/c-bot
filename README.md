# CRBot - Telegram Bot для расписания колледжа

Telegram-бот для получения и отображения расписания занятий колледжа с автоматическим парсингом PDF файлов.

## 🚀 Функциональность

### Основные команды:
- `/start` - приветствие и список команд
- `/ping` - проверка работоспособности
- `/schedule` - расписание на сегодня
- `/schedule_tomorrow` - расписание на завтра
- `/schedule_week` - расписание на неделю
- `/update_schedule` - принудительное обновление расписания

### Автоматические возможности:
- 📥 Скачивание PDF с Google Drive
- 🔍 Парсинг таблицы расписания
- 📅 Извлечение дат, времени, предметов, преподавателей, аудиторий
- 🔄 Автоматическое обновление каждый час
- 👥 Поддержка группы 302Ф

## 🛠️ Технические особенности

- **Парсер PDF**: Автоматическое извлечение данных из таблиц
- **Google Drive интеграция**: Прямое скачивание файлов
- **Умное форматирование**: Красивые сообщения с эмодзи
- **Обработка ошибок**: Информативные сообщения об ошибках
- **Кэширование**: Сохранение данных между запросами

## 📁 Структура проекта

```
CRBot/
├── main.py              # Основной код бота
├── schedule_parser.py   # Модуль парсинга расписания
├── config.py            # Конфигурация и настройки
├── requirements.txt     # Зависимости Python
├── render.yaml          # Конфигурация для Render
├── Procfile             # Команда запуска для Railway
├── .gitignore           # Исключения для Git
└── README.md            # Документация
```

## 🚀 Установка и запуск

### Локально

1. Установите зависимости:
```bash
pip install -r requirements.txt
```

2. Запустите бота:
```bash
python main.py
```

### На Render

1. Создайте аккаунт на [Render](https://render.com/)
2. Подключите ваш GitHub репозиторий
3. Добавьте переменную окружения:
   - `BOT_TOKEN` = ваш токен бота от @BotFather
4. Render автоматически развернет и запустит бота

## 🔧 Настройка

### Конфигурация расписания:
- Измените `GOOGLE_DRIVE_URL` в `config.py` для другого файла
- Настройте `DEFAULT_GROUP` для вашей группы
- Измените `UPDATE_INTERVAL_HOURS` для частоты обновлений

### Поддерживаемые форматы:
- PDF файлы с таблицами расписания
- Google Drive ссылки
- Структурированные данные (дата, время, предмет, преподаватель, аудитория)

## 📚 Зависимости

- **aiogram>=3.4.1** - Telegram Bot API
- **PyPDF2==3.0.1** - Парсинг PDF файлов
- **requests==2.31.0** - HTTP запросы
- **google-auth==2.23.4** - Google API аутентификация
- **python-dotenv==1.0.0** - Переменные окружения

## 🎯 Разработка

### Добавление новых команд:
1. Создайте обработчик в `main.py`
2. Добавьте логику в `schedule_parser.py`
3. Обновите справку в команде `/start`

### Расширение парсера:
- Поддержка других форматов файлов
- Парсинг дополнительных данных
- Интеграция с другими источниками

## 📱 Примеры использования

```
/schedule
📅 Расписание на 01.09.2025:

🕐 13:55-14:40
📚 РАЗГОВОРЫ О ВАЖНОМ
👨‍🏫 
🏢 
──────────────────────────────

🔄 Последнее обновление: 01.09.2025 22:00
```

## 🔒 Безопасность

- Токен бота хранится в переменных окружения
- Ограниченный доступ к Google Drive
- Валидация входных данных
- Обработка ошибок без утечки информации

## 📞 Поддержка

При возникновении проблем:
1. Проверьте логи в Render
2. Убедитесь в корректности Google Drive ссылки
3. Проверьте формат PDF файла

## 🎉 Авторы

Разработано для автоматизации получения расписания колледжа с использованием современных технологий Python и Telegram Bot API.
